<HTML>
	<HEAD>
		<TITLE>Kitchen</TITLE>
	</HEAD>

	<BODY>

		<!-- jQuery Library -->
		<script src="//ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>

		<script TYPE="TEXT/JAVASCRIPT" SRC="http://d3js.org/d3.v3.min.js"></script>
		
		<script>

			//Load a csv file and generate a tree of data.
			d3.csv("timedata.csv", function(csv) {
				
				//Populate a csv object from csv file
				var nested_data = d3.nest()
					.key(function(d) {return d.departmentID;})
						.sortKeys(d3.ascending)
					.key(function(d) {return d.employee;})
						.sortKeys(d3.ascending)
					.key(function(d) {return d.client;})
						.sortKeys(d3.ascending)
					.entries(csv);

				//Display csv object in developer console.
				console.log(nested_data);

				//Create a header/label for a dropdown menu
				d3.select("body")
					.append("h3")
					.text("Please select a department");

				//Create a dropdown menu and populate with departments from csv object.
				d3.select("body")
					.append("select")
					.selectAll("option")
					.data(nested_data)
					.enter()
					.append("option")
					.text(function(d, i) {return d.key;});
			

				//Trigger: On change of dropdown selection, load corresponding data
				d3.select('select')
				    .on("change", function() {

				    	//variable that stores the index of the dropdown option selected 
				    	var dropdownIndex = this.selectedIndex;

  				    	//variable that stores the value of the dropdown option selected   
					    var departmentIndex = this.options[this.selectedIndex].value;
					
					    //removes previous divs to clear previously displayed information selection 
					    d3.select("div")
					    	.remove();

						//creates a div to store listed data
					    d3.select("body")
							.append("div");

						//creates an unordered list and populates it with members of each department
						d3.select("div")
							.append("ul")
							.selectAll("li")
							.data(nested_data[dropdownIndex].values) //the scope of the data that .enter() traverses 
							.enter()
							.append("li")
							.text(function(d,i) {

								return(d.key);
								
							});

					});

			});
				

		</script>
	</BODY>
</HTML>
